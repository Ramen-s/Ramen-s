<header class="nc-header">
  <div class="nc-header__inner">
    <div class="nc-header__logo">
      <%= link_to "LOGO", root_path, class: "nc-logo" %>
    </div>

    <%# 苗字取得（カラム名の違いに備えて候補を順に試す） %>
    <% family_name =
        if current_customer.respond_to?(:last_name) && current_customer.last_name.present?
          current_customer.last_name
        elsif current_customer.respond_to?(:family_name) && current_customer.family_name.present?
          current_customer.family_name
        elsif current_customer.respond_to?(:surname) && current_customer.surname.present?
          current_customer.surname
        else
          ""
        end
    %>

    <div class="nc-header__welcome">
      <% if family_name.present? %>
        ようこそ、<%= family_name %>さん！
      <% else %>
        ようこそ！
      <% end %>
    </div>

    <div class="nc-header__right">
      <nav class="nc-nav">
        <%= link_to "マイページ", customers_my_page_path, class: "nc-btn" %>
        <%= link_to "商品一覧", items_path, class: "nc-btn" %>
        <%= link_to "カート", cart_items_path, class: "nc-btn" %>

        <%= button_to "ログアウト",
              destroy_customer_session_path,
              method: :delete,
              form: { style: "display:inline;" },
              class: "nc-btn" %>
      </nav>

      <form class="nc-search" action="#" method="get">
        <input class="nc-search__input" type="text" name="q" placeholder="Search" />
        <button class="nc-search__icon" type="submit" aria-label="Search">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
            <g stroke="#4da3ff" stroke-width="2" stroke-linecap="round">
              <circle cx="11" cy="11" r="6"/>
              <line x1="16" y1="16" x2="21" y2="21"/>
            </g>
          </svg>
        </button>
      </form>
    </div>
  </div>
</header>